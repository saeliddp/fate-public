<!DOCTYPE html>
<html>
<head>
    <style>
        @import url('https://fonts.googleapis.com/css?family=Kalam&display=swap');

        {% load staticfiles %}
        body {
            background-image: url("{% static 'myapp/snow-top-mountain-under-clear-sky-1054218.jpg' %}");
            background-size: 150%;
        }

        .header {
            padding-top: 8px;
            margin: 0px;
            text-align: center;
            color: white;
            font-family: "verdana";
            font-size: 40px;
        }

        #percentile {
            font-size: 20px;
            color: rgba(255, 200, 132);
        }

        .header1 {
            padding-top: 100px;
        }

        .share {
            color: white;
            font-size: 20px;
            font-family: "verdana";
        }

        .board-title {
            text-align: center;
            font-family: "verdana";
            padding-top: 40px;
            font-size: 25px;
        }

        .mturk-id {
            display: table;
            margin: auto;
            margin-top: 50px;
            text-align: center;
        }

        .mturk-id input {
            margin-top: 5px;
        }

        #phrase {
            display: none;
        }

        #container {
            width: 400px;
            height: auto;
            margin-left: auto;
            margin-right: auto;
            margin-top: 20px;
            border-style: solid;
            border-width: 2px;
            border-color: navajowhite;
            border-radius: 8px;
        }

        .row {
            position: relative;
            display: block;
            width: 100%;
            height: 50px;
            border-bottom: 1px solid #AFAFAF;
        }

        .score {
            font-size: 20px;
            padding-top: 5px;
            position: relative;
            display: inline-block;
            width: 100%;
            line-height: 45px;
            text-align: center;
            font-family: 'Kalam', cursive;
        }

        .row:nth-child(1) {
            background: rgba(255, 255, 255, 0.4);
        }

        .row:nth-child(2) {
            background: gold;
        }

        .row:nth-child(3) {
            background: #c0c0c0;
        }

        .row:nth-child(4) {
            background: #cd7f32;
        }

        .row:nth-child(5) {
            background: rgba(255, 255, 255, 0.4);
        }

        .row:nth-child(6) {
            background: rgba(255, 255, 255, 0.4);
        }

        .share-block {
            position: absolute;
            right: 20px;
        }

        .shares {
            float: right;
        }

        ul.share-buttons {
            list-style: none;
            padding: 0;
        }

        ul.share-buttons li {
            display: inline;
        }

        ul.share-buttons .sr-only {
            position: absolute;
            clip: rect(1px 1px 1px 1px);
            clip: rect(1px, 1px, 1px, 1px);
            padding: 0;
            border: 0;
            height: 1px;
            width: 1px;
            overflow: hidden;
        }

        .chart {
            width: 50%;
            margin-top: 600px;
            margin-left: 25%;
            position: absolute;
        }

        @media (min-width: 1000px) {
            body {
                background-size: 100%;
            }

            .header {
                font-size: 27px;
            }

            .share {
                font-size: 15px;
            }

            .header1 {
                padding-top: 20px;
            }

            .board-title {
                font-size: 15px;
            }

            .chart {
                width: 300px;
                margin-top: 60px;
                margin-left: 0;
                position: absolute;
            }
        }

    </style>

    <meta property="og:url" content="https://shielded-tundra-32718.herokuapp.com"/>
    <meta property="og:type" content="website"/>
    <meta property="og:title" content="Google or Not?"/>
    <meta property="og:description" content="Some description"/>
    {#    <meta property="og:image" content="https://www.your-domain.com/path/image.jpg"/>#}

    <title>Do you Google?</title>
</head>
<body style="background-color: #f2f2f2">
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.3/Chart.bundle.js"></script>

<h1 class="header header1">Thank you for playing!</h1>
<h2 class="header">You scored {{ score }} points!</h2>
<h2 class="header" id="percentile"></h2>
<div class="share-block">
    <p class="share">Share with you friends!</p>
    {#    <ul class="share-buttons">#}
    {#        <li>#}
    {#            <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fshielded-tundra-32718.herokuapp.com%2F&quote="#}
    {#               title="Share on Facebook" target="_blank"><img alt="Share on Facebook"#}
    {#                                                              src="{% static 'myapp/Facebook.png' %}"/></a></li>#}
    {#        <li>#}
    {#            <a href="https://twitter.com/intent/tweet?source=https%3A%2F%2Fshielded-tundra-32718.herokuapp.com%2F&text=:%20https%3A%2F%2Fshielded-tundra-32718.herokuapp.com%2F"#}
    {#               target="_blank" title="Tweet"><img alt="Tweet" src="{% static 'myapp/Twitter.png' %}"/></a></li>#}
    {#        <li>#}
    {#            <a href="http://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fshielded-tundra-32718.herokuapp.com%2F&title=&summary=&source=https%3A%2F%2Fshielded-tundra-32718.herokuapp.com%2F"#}
    {#               target="_blank" title="Share on LinkedIn"><img alt="Share on LinkedIn"#}
    {#                                                              src="{% static 'myapp/LinkedIn.png' %}"/></a></li>#}
    {#        <li><a href="mailto:?subject=&body=:%20https%3A%2F%2Fshielded-tundra-32718.herokuapp.com%2F" target="_blank"#}
    {#               title="Send email"><img alt="Send email" src="{% static 'myapp/Email.png' %}"/></a></li>#}
    {#    </ul>#}
    <div id="fb-root"></div>
    <script>(function (d, s, id) {
        var js, fjs = d.getElementsByTagName(s)[0];
        if (d.getElementById(id)) return;
        js = d.createElement(s);
        js.id = id;
        js.src = "https://connect.facebook.net/en_US/sdk.js#xfbml=1&version=v3.0";
        fjs.parentNode.insertBefore(js, fjs);
    }(document, 'script', 'facebook-jssdk'));</script>

    <!-- Your share button code -->
    <div class="shares">
        <div class="fb-share-button"
             data-href="https://shielded-tundra-32718.herokuapp.com"
             data-layout="button">
        </div>

        <p></p>
        <a href="https://twitter.com/share?ref_src=twsrc%5Etfw" class="twitter-share-button"
           data-url="https://shielded-tundra-32718.herokuapp.com" data-show-count="false"> Tweet </a>
        <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
        <p></p>

        <script src="https://platform.linkedin.com/in.js" type="text/javascript">lang: en_US</script>
        <script type="IN/Share" data-url="https://shielded-tundra-32718.herokuapp.com"></script>
    </div>

</div>


<h3 class="board-title">Leaderboard TOP 5!</h3>

<div id="container">
    {% load staticfiles %}
    <div class="row">
        <div class="score">Score</div>
    </div>

    {% for datum in top_five %}
        {% if forloop.counter < 6 %}
            <div class="row">
                <div class="score">{{ datum.0 }}</div>
            </div>
        {% endif %}
    {% endfor %}


</div>


<div class="chart">
    <canvas id="myChart" width="200" height="200"></canvas>
</div>


<script>

    function Quartile(data, q) {
        data = Array_Sort_Numbers(data);
        var pos = ((data.length) - 1) * q;
        var base = Math.floor(pos);
        var rest = pos - base;
        if ((data[base + 1] !== undefined)) {
            return data[base] + rest * (data[base + 1] - data[base]);
        } else {
            return data[base];
        }
    }

    function Array_Sort_Numbers(inputarray) {
        return inputarray.sort(function (a, b) {
            return a - b;
        });
    }

    var allscore = [];
    {% for datum in score_dict %}
        {#var s = {{ datum.0 }}#}
        {#    var freq = {{ datum.1 }}#}
        for (let i = 0; i < {{ datum.1 }}; i++) {
            allscore.push({{ datum.0 }})
        }
    {% endfor %}

    var per25 = Quartile(allscore, 0.25);
    var per50 = Quartile(allscore, 0.5);
    var per75 = Quartile(allscore, 0.75);
    var per90 = Quartile(allscore, 0.9);


    function Check_Quartile(score) {
        if (score > per90) {
            return ("You exceeded 90% of other players! It's hard to find others like you!")
        } else if (score > per75) {
            return ("You exceeded 75% of other players! Keep it going!")
        } else if (score > per50) {
            return ("You exceeded 50% of other players! You have average eyes and got deceive as much as other do!")
        } else if (score > per25) {
            return ("You exceeded 25% of other players! Get some training and come back!")
        } else {
            return ("You exceeded 10% of other players! It's okay my friend. Get some glasses and try again!")
        }
    }

    document.getElementById("percentile").innerText =  Check_Quartile({{ score }})

    var newlist = []
    var current_score = []
    {% for datum in score_dict %}
        {% if datum.0 != score %}
            var xv = {{ datum.0 }}
            var yv = {{ datum.1 }}
            var point = {x: xv, y: yv}
            newlist.push(point)
        {% endif %}

        {% if datum.0 == score %}
            var xv2 = {{ datum.0 }}
            var yv2 = {{ datum.1 }}
            var point2 = {x: xv2, y: yv2}
            current_score.push(point2)
        {% endif %}
    {% endfor %}

    var ctx = document.getElementById('myChart').getContext('2d');
    var myChart = new Chart(ctx, {
        type: 'scatter',
        data: {
            datasets: [{
                label: 'Score Distribution',
                data: newlist,
                pointBackgroundColor: 'rgba(255, 206, 86, 1)',
                borderColor: 'rgba(255, 206, 86, 1)'
            },
                {
                    label: 'Your Position',
                    data: current_score,
                    pointBackgroundColor: 'rgb(56,255,106)',
                    borderColor: 'rgb(56,255,106)'
                }]
        },
        options: {
            legend: {
                labels: {
                    fontColor: 'rgba(255, 255, 255)'
                }
            },

            scales: {
                xAxes: [{
                    gridLines: {
                        color: 'rgba(255, 255, 255, 0.3)'
                    },
                    ticks: {
                        fontColor: "#fff"
                    },
                    scaleLabel: {
                        display: true,
                        labelString: 'score',
                        fontColor: "#fff"
                    }
                }],
                yAxes: [{
                    gridLines: {
                        color: 'rgba(255, 255, 255, 0.3)'
                    },
                    ticks: {
                        fontColor: "#fff"
                    },
                    scaleLabel: {
                        display: true,
                        labelString: 'frequency',
                        fontColor: "#fff"
                    }
                }]
            }

        }
    })

</script>

</body>