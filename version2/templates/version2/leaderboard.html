<!DOCTYPE html>
<html>
<head>
    <style>
        @import url('https://fonts.googleapis.com/css?family=Kalam&display=swap');

        {% load staticfiles %}

        .block {
            text-align: center;
        }

        .header {
            padding-top: 8px;
            margin: 0px;
            text-align: center;
            color: black;
            font-family: "verdana";
            font-size: 60px;
        }

        .header1 {
            padding-top: 100px;
        }

        .header2 {
            font-size: 50px;
            color: crimson;
        }

        #percentile {
            color: #565656;
            padding: 20px;
            font-size: 50px;
        }

        #text {
            font-family: "verdana";
            font-size: 15px;
            padding-left: 50px;
            padding-right: 50px;
            color: black;
        }

        .share {
            color: black;
            font-size: 40px;
            font-family: "verdana";
            font-weight: bold;
        }

        .board-title {
            text-align: center;
            font-family: "verdana";
            padding-top: 40px;
            font-size: 35px;
            font-weight: lighter;
            color: #ffc923;
        }

        .mturk-id input {
            margin-top: 5px;
        }

        #container {
            width: 70%;
            height: auto;
            margin-left: auto;
            margin-right: auto;
            margin-top: 20px;
            border-style: solid;
            border-width: 2px;
            border-color: navajowhite;
            border-radius: 8px;
        }

        .row {
            position: relative;
            display: block;
            width: 100%;
            height: 60px;
            border-bottom: 1px solid #AFAFAF;
        }

        .score, .name {
            font-size: 40px;
            padding-top: 11px;
            position: relative;
            display: inline-block;
            width: 20%;
            line-height: 45px;
            text-align: center;
            font-family: 'Kalam', cursive;
        }

        .name {
            width: 75%;
        }

        .row:nth-child(1) {
            background: rgba(255, 255, 255, 0.4);
        }

        .row:nth-child(2) {
            background: gold;
        }

        .row:nth-child(3) {
            background: #c0c0c0;
        }

        .row:nth-child(4) {
            background: #cd7f32;
        }

        .row:nth-child(5) {
            background: rgba(255, 255, 255, 0.4);
        }

        .row:nth-child(6) {
            background: rgba(255, 255, 255, 0.4);
        }

        .share-block {
            text-align: center;
            margin-bottom: 60px;
        }

        .chart {
            width: 80%;
            margin-left: 10%;
        }

        #badge {
            padding-top: 30px;
            height: 50%;
            width: 50%;
            margin-left: 25%;
        }

        .board {
            background: #2d1c00;
            padding-bottom: 50px;
            margin-bottom: 60px;
        }


        @media (min-width: 1000px) {
            body {
                background-image: url("{% static 'myapp/BG04.png' %}");
            }

            .block {
                background: white;
                margin: 80px 220px;
                border-radius: 10px;
                border: 2px solid #cbcbcb;
            }

            #badge {
                padding-top: 30px;
                height: 20%;
                width: 20%;
                margin-left: 40%;
            }

            #percentile {
                padding: 0px;
                font-size: 20px;
            }

            .header {
                font-size: 25px;
            }

            .share {
                font-size: 15px;
            }

            .share-block {
                margin-top: 30px;
                margin-bottom: 30px;
            }

            .header1 {
                padding-top: 20px;
            }

            .board-title {
                font-size: 20px;
            }

            .row {
                height: 40px;
            }

            .score, .name {
                font-size: 20px;
                padding-top: 0px;
            }

            .chart {
                width: 45%;
                padding-left: 15%;
            }
        }

    </style>

    <meta property="og:url" content="https://shielded-tundra-32718.herokuapp.com"/>
    <meta property="og:type" content="website"/>
    <meta property="og:title" content="Google or Not?"/>
    <meta property="og:description" content="Some description"/>
    <meta property="og:image" content="https://shielded-tundra-32718.herokuapp.com/static/myapp/gornot.png"/>

    <title>Do you Google?</title>
</head>
<body style="background-color: #f2f2f2">
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.3/Chart.bundle.js"></script>
<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
        integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
        crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"
        integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
        crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"
        integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy"
        crossorigin="anonymous"></script>
<script src="jquery-3.4.1.min.js"></script>

<div class="block">
    <h1 class="header header1">Thank you for playing!</h1>
    <h2 class="header header2">You scored {{ score }} points!</h2>
    <img id="badge">
    <p></p>
    <h2 class="header" id="percentile"></h2>
    <p id="text"></p>


    <div class="share-block">
        <p class="share">Share with you friends!</p>
        <div id="fb-root"></div>
        <script>(function (d, s, id) {
            var js, fjs = d.getElementsByTagName(s)[0];
            if (d.getElementById(id)) return;
            js = d.createElement(s);
            js.id = id;
            js.src = "https://connect.facebook.net/en_US/sdk.js#xfbml=1&version=v3.0";
            fjs.parentNode.insertBefore(js, fjs);
        }(document, 'script', 'facebook-jssdk'));</script>

        <!-- Your share button code -->
        <div class="shares">
            <div class="fb-share-button"
                 data-href="https://shielded-tundra-32718.herokuapp.com"
                 data-layout="button">
            </div>

            <a href="https://twitter.com/share?ref_src=twsrc%5Etfw" class="twitter-share-button"
               data-url="https://shielded-tundra-32718.herokuapp.com" data-show-count="false"> Tweet </a>
            <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

            <script src="https://platform.linkedin.com/in.js" type="text/javascript">lang: en_US</script>
            <script type="IN/Share" data-url="https://shielded-tundra-32718.herokuapp.com"></script>
        </div>

    </div>


    <div class="board">
        <h3 class="board-title">Leaderboard TOP 5!</h3>

        <div id="container">
            {% load staticfiles %}
            <div class="row">
                <div class="name">Username</div>
                <div class="score">Score</div>
            </div>

            {% for datum in top_five %}
                {% if forloop.counter < 6 %}
                    <div class="row">
                        <div class="name">{{ datum.1 }}</div>
                        <div class="score">{{ datum.0 }}</div>
                    </div>
                {% endif %}
            {% endfor %}
        </div>
    </div>


    <div class="chart">
        <canvas id="myChart" width="200" height="200"></canvas>
    </div>

    <div class="share-block">
        <p class="share">Share with you friends!</p>
        <div id="fb-root"></div>
        <script>(function (d, s, id) {
            var js, fjs = d.getElementsByTagName(s)[0];
            if (d.getElementById(id)) return;
            js = d.createElement(s);
            js.id = id;
            js.src = "https://connect.facebook.net/en_US/sdk.js#xfbml=1&version=v3.0";
            fjs.parentNode.insertBefore(js, fjs);
        }(document, 'script', 'facebook-jssdk'));</script>

        <!-- Your share button code -->
        <div class="shares">
            <div class="fb-share-button"
                 data-href="https://shielded-tundra-32718.herokuapp.com"
                 data-layout="button">
            </div>

            <a href="https://twitter.com/share?ref_src=twsrc%5Etfw" class="twitter-share-button"
               data-url="https://shielded-tundra-32718.herokuapp.com" data-show-count="false"> Tweet </a>
            <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

            <script src="https://platform.linkedin.com/in.js" type="text/javascript">lang: en_US</script>
            <script type="IN/Share" data-url="https://shielded-tundra-32718.herokuapp.com"></script>
        </div>

    </div>


    <script>

        function Quartile(data, q) {
            data = Array_Sort_Numbers(data);
            var pos = ((data.length) - 1) * q;
            var base = Math.floor(pos);
            var rest = pos - base;
            if ((data[base + 1] !== undefined)) {
                return data[base] + rest * (data[base + 1] - data[base]);
            } else {
                return data[base];
            }
        }

        function Array_Sort_Numbers(inputarray) {
            return inputarray.sort(function (a, b) {
                return a - b;
            });
        }

        var allscore = [];
        {% for datum in score_dict %}
            {#var s = {{ datum.0 }}#}
            {#    var freq = {{ datum.1 }}#}
            for (let i = 0; i < {{ datum.1 }}; i++) {
                allscore.push({{ datum.0 }})
            }
        {% endfor %}

        var per20 = Quartile(allscore, 0.2);
        var per40 = Quartile(allscore, 0.4);
        var per60 = Quartile(allscore, 0.6);
        var per80 = Quartile(allscore, 0.8);


        function Check_Quartile(score) {
            if (score > per80) {
                document.getElementById("badge").src = "{% static 'myapp/eaglebadge.png' %}"
                document.getElementById("percentile").innerText = "Google Conqueror!"
                document.getElementById("text").innerHTML = "You exceeded <span style=\"color: green; \">80%</span> of other players! Your eyes can peer through Google AI. It is hard to find others like you."
            } else if (score > per60) {
                document.getElementById("badge").src = "{% static 'myapp/owlbadge.png' %}"
                document.getElementById("percentile").innerText = "You almost beat Google!"
                document.getElementById("text").innerText = "You exceeded <span style=\"color: green; \">60%</span> of other players! Great vision my fellow owls. Keep it going."
            } else if (score > per40) {
                document.getElementById("badge").src = "{% static 'myapp/goatbadge.png' %}"
                document.getElementById("percentile").innerText = "Not bad for Google’s prey! "
                document.getElementById("text").innerText = "You exceeded <span style=\"color: green; \">40%</span>  of other players! Your eyes can peer through Google AI. It is hard to find others like you."
            } else if (score > per20) {
                document.getElementById("badge").src = "{% static 'myapp/batbadge.png' %}"
                document.getElementById("percentile").innerText = "You are blind as a bat!"
                document.getElementById("text").innerText = "You exceeded <span style=\"color: green; \">20%</span>  of other players! Google knocked you down!"
            } else {
                document.getElementById("badge").src = "{% static 'myapp/molebadge.png' %}"
                document.getElementById("percentile").innerText = "Google knocked you down!"
                document.getElementById("text").innerText = "You exceeded <span style=\"color: green; \">10%</span>  of other players! It’s alright little friend, Go get some glasses and try again"
            }
        }

        Check_Quartile({{ score }})

        var newlist = []
        var current_score = []
        {% for datum in score_dict %}
            {% if datum.0 != score %}
                var xv = {{ datum.0 }}
                var yv = {{ datum.1 }}
                var point = {x: xv, y: yv}
                newlist.push(point)
            {% endif %}

            {% if datum.0 == score %}
                var xv2 = {{ datum.0 }}
                var yv2 = {{ datum.1 }}
                var point2 = {x: xv2, y: yv2}
                current_score.push(point2)
            {% endif %}
        {% endfor %}

        var ctx = document.getElementById('myChart').getContext('2d');
        if ($(window).width() < 1000) {
            var myChart = new Chart(ctx, {
                type: 'scatter',
                data: {
                    datasets: [{
                        label: 'Other Participants’ Scores',
                        data: newlist,
                        pointBackgroundColor: 'rgb(255,192,0)',
                        borderColor: 'rgb(255,192,2)',
                        pointRadius: 10
                    },
                        {
                            label: 'Your Score',
                            data: current_score,
                            pointBackgroundColor: 'rgb(0,255,52)',
                            borderColor: 'rgb(0,255,53)',
                            pointRadius: 10
                        }]
                },
                options: {
                    legend: {
                        labels: {
                            fontColor: 'black',
                            fontSize: 30
                        }
                    },

                    scales: {
                        xAxes: [{
                            gridLines: {
                                color: 'rgb(153,153,153)'
                            },
                            ticks: {
                                fontColor: 'black',
                                fontSize: 20
                            },
                            scaleLabel: {
                                display: true,
                                labelString: 'Score',
                                fontColor: 'rgb(153,153,153)',
                                fontSize: 30
                            }
                        }],
                        yAxes: [{
                            gridLines: {
                                color: 'rgb(153,153,153)'
                            },
                            ticks: {
                                fontColor: 'black',
                                fontSize: 20
                            },
                            scaleLabel: {
                                display: true,
                                labelString: 'Frequency',
                                fontColor: 'rgb(153,153,153)',
                                fontSize: 30
                            }
                        }]
                    }

                }
            })
        } else {
            var myChart = new Chart(ctx, {
                type: 'scatter',
                data: {
                    datasets: [{
                        label: 'Other Participants’ Scores',
                        data: newlist,
                        pointBackgroundColor: 'rgb(255,192,0)',
                        borderColor: 'rgb(255,192,2)',
                        pointRadius: 6
                    },
                        {
                            label: 'Your Score',
                            data: current_score,
                            pointBackgroundColor: 'rgb(0,255,52)',
                            borderColor: 'rgb(0,255,53)',
                            pointRadius: 6
                        }]
                },
                options: {
                    legend: {
                        labels: {
                            fontColor: 'black',
                            fontSize: 20
                        }
                    },

                    scales: {
                        xAxes: [{
                            gridLines: {
                                color: 'rgb(153,153,153)'
                            },
                            ticks: {
                                fontColor: 'black',
                                fontSize: 10
                            },
                            scaleLabel: {
                                display: true,
                                labelString: 'Score',
                                fontColor: 'rgb(153,153,153)',
                                fontSize: 20
                            }
                        }],
                        yAxes: [{
                            gridLines: {
                                color: 'rgb(153,153,153)'
                            },
                            ticks: {
                                fontColor: 'black',
                                fontSize: 10
                            },
                            scaleLabel: {
                                display: true,
                                labelString: 'Frequency',
                                fontColor: 'rgb(153,153,153)',
                                fontSize: 20
                            }
                        }]
                    }

                }
            })
        }

    </script>

</body>